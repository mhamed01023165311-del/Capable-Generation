<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø³Ø§Ø¨Ù‚Ø© Ø±Ù…Ø¶Ø§Ù†</title>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        /* ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø®Ù„ÙÙŠØ© */
        #bg-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -2;
        }

        /* Ø·Ø¨Ù‚Ø© Ø³ÙˆØ¯Ø§Ø¡ Ø´ÙØ§ÙØ© */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: -1;
        }

        .container {
            width: 90%;
            max-width: 600px;
            padding: 20px;
            z-index: 1;
        }

        /* ===== Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ ===== */
        .login-box {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            border: 2px solid #ffd700;
            border-radius: 25px;
            padding: 40px 30px;
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.3);
            animation: fadeIn 0.5s;
        }

        .logo {
            text-align: center;
            margin-bottom: 20px;
        }

        .logo img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 3px solid #ffd700;
            box-shadow: 0 0 20px #ffd700;
        }

        h2 {
            color: #ffd700;
            text-align: center;
            margin-bottom: 25px;
            font-size: 2rem;
            text-shadow: 0 0 10px #ffd700;
        }

        input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #ffd700;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }

        input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        button {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 10px;
            background: #ffd700;
            color: black;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        button:hover {
            transform: scale(1.02);
            box-shadow: 0 0 20px #ffd700;
        }

        /* ===== ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© ===== */
        .quiz-box {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            border: 2px solid #ffd700;
            border-radius: 25px;
            padding: 40px 30px;
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.3);
        }

        .question-text {
            font-size: 2rem;
            color: #ffd700;
            text-align: center;
            margin-bottom: 30px;
            font-weight: bold;
        }

        .answer-btn {
            width: 100%;
            padding: 18px;
            margin: 10px 0;
            border: 2px solid #ffd700;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: right;
        }

        .answer-btn:hover {
            background: rgba(255, 215, 0, 0.3);
        }

        /* ===== ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¯ÙŠØ± (Ø²ÙŠ Ø§Ù„Ø£ÙˆÙ„) ===== */
        .admin-box {
            background: #0b101b;
            color: white;
            width: 100%;
            min-height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            padding: 30px;
            overflow-y: auto;
            z-index: 2000;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #ffd700;
            padding-bottom: 15px;
        }

        .admin-header h2 {
            color: #ffd700;
            font-size: 2rem;
        }

        .admin-section {
            background: #1a202c;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 1px solid #ffd700;
        }

        .admin-section h3 {
            color: #ffd700;
            margin-bottom: 20px;
            font-size: 1.4rem;
            border-right: 4px solid #ffd700;
            padding-right: 15px;
        }

        .stats-row {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            flex: 1;
            background: #2d3748;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card.correct {
            border: 2px solid #28a745;
        }

        .stat-card.wrong {
            border: 2px solid #dc3545;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
        }

        .stat-number.correct {
            color: #28a745;
        }

        .stat-number.wrong {
            color: #dc3545;
        }

        .admin-buttons {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .admin-btn {
            flex: 1;
            padding: 15px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid;
            color: white;
            cursor: pointer;
        }

        .admin-btn.correct {
            border-color: #28a745;
        }

        .admin-btn.wrong {
            border-color: #dc3545;
        }

        .archive-item {
            background: #2d3748;
            padding: 20px;
            margin-top: 15px;
            border-radius: 10px;
            border-right: 4px solid #ffd700;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            float: left;
        }

        .hidden {
            display: none !important;
        }

        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 30px;
            border-radius: 50px;
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #ffd700;
            color: white;
            z-index: 10000;
            animation: slideUp 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { bottom: 20px; opacity: 0; }
            to { bottom: 30px; opacity: 1; }
        }

        @media (max-width: 768px) {
            .quiz-box { padding: 20px; }
            .question-text { font-size: 1.5rem; }
            .answer-btn { font-size: 1.1rem; padding: 15px; }
            .stats-row { flex-direction: column; }
        }
    </style>
</head>
<body>
    <!-- ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø®Ù„ÙÙŠØ© -->
    <video autoplay muted loop id="bg-video">
        <source src="background.mp4" type="video/mp4">
    </video>
    <div class="overlay"></div>

    <!-- Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø®Ù„ÙÙŠØ© -->
    <audio id="bg-music" loop>
        <source src="music.mp3" type="audio/mpeg">
    </audio>

    <div class="container">
        <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
        <div id="loginScreen" class="login-box">
            <div class="logo">
                <img src="loge.png" alt="Logo" onerror="this.src='https://via.placeholder.com/100x100?text=ğŸŒ™'">
            </div>
            <h2>ğŸŒ™ Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ…</h2>
            <input type="email" id="emailInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
            <button onclick="handleLogin()">Ø¯Ø®ÙˆÙ„</button>
        </div>

        <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© -->
        <div id="quizScreen" class="quiz-box hidden">
            <div class="logo">
                <img src="loge.png" alt="Logo">
            </div>
            <h2 id="questionText">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h2>
            <div id="answersContainer"></div>
        </div>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¯ÙŠØ± (Ù…Ù†ÙØµÙ„Ø©) -->
    <div id="adminScreen" class="admin-box hidden">
        <div class="admin-header">
            <h2>âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
            <button onclick="logout()" style="background:#dc3545; color:white; padding:8px 15px; border:none; border-radius:5px;">ğŸšª Ø®Ø±ÙˆØ¬</button>
        </div>

        <div class="admin-section">
            <h3>â• Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯</h3>
            <input type="text" id="qText" placeholder="Ø§Ù„Ø³Ø¤Ø§Ù„">
            <input type="text" id="a1" placeholder="Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰">
            <input type="text" id="a2" placeholder="Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©">
            <input type="text" id="a3" placeholder="Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©">
            <input type="text" id="a4" placeholder="Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©">
            <input type="number" id="correct" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© (1-4)" min="1" max="4">
            <button onclick="addQuestion()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø³Ø¤Ø§Ù„</button>
        </div>

        <div class="admin-section">
            <h3>ğŸ“Š ØªØµÙ†ÙŠÙ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª</h3>
            
            <div class="stats-row" id="statsContainer">
                <div class="stat-card correct">
                    <div class="stat-number correct" id="correctCount">0</div>
                    <div>Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø©</div>
                </div>
                <div class="stat-card wrong">
                    <div class="stat-number wrong" id="wrongCount">0</div>
                    <div>Ø¥Ø¬Ø§Ø¨Ø§Øª Ø®Ø§Ø·Ø¦Ø©</div>
                </div>
            </div>

            <div class="admin-buttons">
                <button class="admin-btn correct" onclick="showCorrectAnswers()">âœ… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©</button>
                <button class="admin-btn wrong" onclick="showWrongAnswers()">âŒ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø®Ø§Ø·Ø¦Ø©</button>
            </div>
        </div>

        <div class="admin-section">
            <h3>ğŸ—‚ï¸ Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h3>
            <div id="archiveContainer"></div>
        </div>
    </div>

    <div id="toastMessage" class="toast hidden"></div>

    <script>
        // ==================== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase ====================
        const firebaseConfig = {
            apiKey: "AIzaSyAutas4LwSZUuhk6mJquT_n5LuRPyuCZUc",
            authDomain: "ramadan-quiz-a4778.firebaseapp.com",
            projectId: "ramadan-quiz-a4778",
            storageBucket: "ramadan-quiz-a4778.firebasestorage.app",
            messagingSenderId: "574405195850",
            appId: "1:574405195850:web:0947812576a5aee2540eb3"
        };

        // ØªÙ‡ÙŠØ¦Ø© Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ==================== Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ====================
        let audioContext = null;
        let audioSource = null;

        async function setupMusic() {
            try {
                // Ø¥Ù†Ø´Ø§Ø¡ AudioContext
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Ø¬Ù„Ø¨ Ù…Ù„Ù Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰
                const response = await fetch('music.mp3');
                const arrayBuffer = await response.arrayBuffer();
                const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);

                // Ø£Ø®Ø° Ø£ÙˆÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ
                const duration = Math.min(5, audioBuffer.duration);
                const sampleRate = audioBuffer.sampleRate;
                const samplesNeeded = duration * sampleRate;
                
                // Ø¥Ù†Ø´Ø§Ø¡ buffer Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù…Ù‚Ø·Ø¹
                const trimmedBuffer = audioContext.createBuffer(
                    audioBuffer.numberOfChannels,
                    samplesNeeded,
                    sampleRate
                );

                // Ù†Ø³Ø® Ø£ÙˆÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ
                for (let channel = 0; channel < audioBuffer.numberOfChannels; channel++) {
                    const originalData = audioBuffer.getChannelData(channel);
                    const trimmedData = trimmedBuffer.getChannelData(channel);
                    for (let i = 0; i < samplesNeeded; i++) {
                        trimmedData[i] = originalData[i];
                    }
                }

                // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ÙÙŠ Ø­Ù„Ù‚Ø©
                audioSource = audioContext.createBufferSource();
                audioSource.buffer = trimmedBuffer;
                audioSource.loop = true;
                audioSource.connect(audioContext.destination);
                audioSource.start();
                
                // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ù…Ø¤Ù‚ØªØ§Ù‹
                audioContext.suspend();
            } catch (error) {
                console.log('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰:', error);
            }
        }

        // ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰
        function playMusic() {
            if (audioContext && audioContext.state === 'suspended') {
                audioContext.resume();
            }
        }

        function stopMusic() {
            if (audioContext && audioContext.state === 'running') {
                audioContext.suspend();
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø¹Ù†Ø¯ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø©
        setupMusic();

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø¹Ù†Ø¯ Ø£ÙˆÙ„ ØªÙØ§Ø¹Ù„
        document.body.addEventListener('click', function initMusic() {
            playMusic();
            document.body.removeEventListener('click', initMusic);
        });

        // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('beforeunload', function() {
            stopMusic();
        });

        // ==================== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ====================
        let currentUser = null;
        let isAdmin = false;
        let currentQuestion = null;

        // ==================== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ====================
        function showMessage(text, isError = false) {
            const toast = document.getElementById('toastMessage');
            toast.textContent = text;
            toast.style.borderColor = isError ? '#dc3545' : '#ffd700';
            toast.classList.remove('hidden');
            setTimeout(() => toast.classList.add('hidden'), 3000);
        }

        // ==================== Ø§Ù„Ø¯Ø®ÙˆÙ„ ====================
        async function handleLogin() {
            const email = document.getElementById('emailInput').value.trim();
            
            if (!email) {
                showMessage('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', true);
                return;
            }

            try {
                // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Firebase
                await db.collection('users').doc(email).set({
                    email: email,
                    lastLogin: new Date().toISOString()
                });

                currentUser = email;
                isAdmin = (email === 'admin@ramadan.com');

                // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
                document.getElementById('loginScreen').classList.add('hidden');

                if (isAdmin) {
                    document.getElementById('adminScreen').classList.remove('hidden');
                    loadAdminData();
                } else {
                    document.getElementById('quizScreen').classList.remove('hidden');
                    loadQuestion();
                }

                showMessage('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ');
            } catch (error) {
                showMessage('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„', true);
                console.log(error);
            }
        }

        // ==================== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„ ====================
        async function loadQuestion() {
            try {
                const doc = await db.collection('settings').doc('current').get();
                
                if (doc.exists) {
                    currentQuestion = doc.data();
                } else {
                    // Ø³Ø¤Ø§Ù„ Ø§ÙØªØ±Ø§Ø¶ÙŠ
                    currentQuestion = {
                        text: "Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø³ÙˆØ±Ø© Ø§Ù„ØªÙŠ ÙØ±Ø¶ ÙÙŠÙ‡Ø§ Ø§Ù„ØµÙŠØ§Ù…ØŸ",
                        answers: ["Ø§Ù„Ø¨Ù‚Ø±Ø©", "Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†", "Ø§Ù„Ø£Ù†ÙØ§Ù„", "Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©"],
                        correct: 1
                    };
                }

                document.getElementById('questionText').textContent = currentQuestion.text;
                
                const container = document.getElementById('answersContainer');
                container.innerHTML = '';
                
                currentQuestion.answers.forEach((answer, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'answer-btn';
                    btn.textContent = answer;
                    btn.onclick = () => submitAnswer(index + 1);
                    container.appendChild(btn);
                });
            } catch (error) {
                showMessage('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„', true);
            }
        }

        // ==================== ØªØ³Ø¬ÙŠÙ„ Ø¥Ø¬Ø§Ø¨Ø© ====================
        async function submitAnswer(index) {
            try {
                await db.collection('answers').add({
                    user: currentUser,
                    question: currentQuestion.text,
                    answer: currentQuestion.answers[index - 1],
                    isCorrect: (index === currentQuestion.correct),
                    timestamp: new Date().toISOString()
                });

                showMessage('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¥Ø¬Ø§Ø¨ØªÙƒ');
            } catch (error) {
                showMessage('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„', true);
            }
        }

        // ==================== Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø¯ÙŠØ± ====================
        async function addQuestion() {
            const question = {
                text: document.getElementById('qText').value,
                answers: [
                    document.getElementById('a1').value,
                    document.getElementById('a2').value,
                    document.getElementById('a3').value,
                    document.getElementById('a4').value
                ],
                correct: parseInt(document.getElementById('correct').value),
                createdAt: new Date().toISOString()
            };

            if (!question.text || question.answers.some(a => !a) || !question.correct) {
                showMessage('Ø§Ù…Ù„Ø£ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', true);
                return;
            }

            try {
                // Ø­ÙØ¸ ÙƒØ³Ø¤Ø§Ù„ Ø­Ø§Ù„ÙŠ
                await db.collection('settings').doc('current').set(question);
                
                // Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø£Ø±Ø´ÙŠÙ
                await db.collection('archive').add(question);

                showMessage('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø³Ø¤Ø§Ù„');
                setTimeout(() => location.reload(), 1500);
            } catch (error) {
                showMessage('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸', true);
            }
        }

        async function loadAdminData() {
            try {
                // Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
                const answersSnapshot = await db.collection('answers').get();
                let correct = 0, wrong = 0;
                const answers = [];
                
                answersSnapshot.forEach(doc => {
                    const data = doc.data();
                    answers.push(data);
                    if (data.isCorrect) correct++;
                    else wrong++;
                });

                document.getElementById('correctCount').textContent = correct;
                document.getElementById('wrongCount').textContent = wrong;

                // Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø±Ø´ÙŠÙ
                const archiveSnapshot = await db.collection('archive').get();
                const container = document.getElementById('archiveContainer');
                container.innerHTML = '';

                archiveSnapshot.forEach(doc => {
                    const q = doc.data();
                    
                    // Ø¥Ø¬Ø§Ø¨Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„
                    const questionAnswers = answers.filter(a => a.question === q.text);
                    
                    let answersHtml = '';
                    if (questionAnswers.length > 0) {
                        answersHtml = questionAnswers.map(a => `
                            <div style="color: ${a.isCorrect ? '#28a745' : '#dc3545'}; margin: 5px 0;">
                                ${a.isCorrect ? 'âœ…' : 'âŒ'} ${a.user}: ${a.answer}
                            </div>
                        `).join('');
                    } else {
                        answersHtml = '<div style="color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø¨Ø§Øª</div>';
                    }

                    const div = document.createElement('div');
                    div.className = 'archive-item';
                    div.innerHTML = `
                        <strong style="display:block; margin-bottom:10px;">ğŸ“Œ ${q.text}</strong>
                        ${answersHtml}
                    `;
                    container.appendChild(div);
                });
            } catch (error) {
                showMessage('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', true);
            }
        }

        async function showCorrectAnswers() {
            try {
                const snapshot = await db.collection('answers').where('isCorrect', '==', true).get();
                const answers = [];
                snapshot.forEach(doc => answers.push(doc.data()));
                
                if (answers.length === 0) {
                    showMessage('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø©', true);
                    return;
                }
                
                let message = 'âœ… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©:\n\n';
                answers.forEach(a => {
                    message += `ğŸ“§ ${a.user}\nğŸ“ ${a.answer}\n\n`;
                });
                
                alert(message);
            } catch (error) {
                showMessage('Ø®Ø·Ø£', true);
            }
        }

        async function showWrongAnswers() {
            try {
                const snapshot = await db.collection('answers').where('isCorrect', '==', false).get();
                const answers = [];
                snapshot.forEach(doc => answers.push(doc.data()));
                
                if (answers.length === 0) {
                    showMessage('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø¨Ø§Øª Ø®Ø§Ø·Ø¦Ø©', true);
                    return;
                }
                
                let message = 'âŒ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø®Ø§Ø·Ø¦Ø©:\n\n';
                answers.forEach(a => {
                    message += `ğŸ“§ ${a.user}\nğŸ“ ${a.answer}\n\n`;
                });
                
                alert(message);
            } catch (error) {
                showMessage('Ø®Ø·Ø£', true);
            }
        }

        function logout() {
            stopMusic();
            location.reload();
        }
    </script>
</body>
    </html>
